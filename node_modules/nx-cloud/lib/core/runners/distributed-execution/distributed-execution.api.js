const a10_0x1742=['runGroup:\x20','status','defineProperty','dteStart','parseCommand','hash','enabled','__esModule','message','then','createMetricRecorder','target','value','createApiAxiosInstance','../../../utilities/environment','DistributedExecutionApi','completeRunGroup','parallel','VERBOSE_LOGGING','map','dteStatus','false','/nx-cloud/executions/complete-run-group','axiosException','completeRunGroupWithError','createStartRequest','data','recordMetric','error','error:\x20','RUNNER_FAILURE_PERF_ENTRY','axiosMultipleTries','../../../utilities/axios','mapRespToPerfEntry','post','ciExecutionEnv:\x20','apiAxiosInstance','apply','response','stopAgentsOnFailure','__awaiter','configuration','maxParallel','note','NX_CLOUD_DISTRIBUTED_EXECUTION_AGENT_COUNT','start','Completing\x20with\x20an\x20error','projectRoot','../../../utilities/metric-logger','Starting\x20a\x20distributed\x20execution','Workspace\x20is\x20disabled.\x20Cannot\x20perform\x20distributed\x20task\x20executions.','true','stringify'];(function(_0x58f1ea,_0x17423c){const _0x1c9507=function(_0x172589){while(--_0x172589){_0x58f1ea['push'](_0x58f1ea['shift']());}};_0x1c9507(++_0x17423c);}(a10_0x1742,0x1d9));const a10_0x1c95=function(_0x58f1ea,_0x17423c){_0x58f1ea=_0x58f1ea-0x0;let _0x1c9507=a10_0x1742[_0x58f1ea];return _0x1c9507;};'use strict';var __awaiter=this&&this[a10_0x1c95('0x2c')]||function(_0x5b8b43,_0x1e77d0,_0x25f719,_0x11bdc6){function _0x731486(_0x788452){return _0x788452 instanceof _0x25f719?_0x788452:new _0x25f719(function(_0x11d228){_0x11d228(_0x788452);});}return new(_0x25f719||(_0x25f719=Promise))(function(_0x1b32a2,_0xfdfde5){function _0x2d6971(_0x300378){try{_0x5133ad(_0x11bdc6['next'](_0x300378));}catch(_0x40f534){_0xfdfde5(_0x40f534);}}function _0x2e483d(_0x46e56e){try{_0x5133ad(_0x11bdc6['throw'](_0x46e56e));}catch(_0x17cc33){_0xfdfde5(_0x17cc33);}}function _0x5133ad(_0x5abb05){_0x5abb05['done']?_0x1b32a2(_0x5abb05[a10_0x1c95('0x10')]):_0x731486(_0x5abb05[a10_0x1c95('0x10')])[a10_0x1c95('0xd')](_0x2d6971,_0x2e483d);}_0x5133ad((_0x11bdc6=_0x11bdc6[a10_0x1c95('0x29')](_0x5b8b43,_0x1e77d0||[]))['next']());});};Object[a10_0x1c95('0x6')](exports,a10_0x1c95('0xb'),{'value':!![]});exports[a10_0x1c95('0x1d')]=exports[a10_0x1c95('0x13')]=void 0x0;const axios_1=require(a10_0x1c95('0x24'));const environment_1=require(a10_0x1c95('0x12'));const metric_logger_1=require(a10_0x1c95('0x34'));const serializer_overrides_1=require('../../../utilities/serializer-overrides');const {output}=require('../../../utilities/nx-imports-light');class DistributedExecutionApi{constructor(_0x120157){this[a10_0x1c95('0x28')]=(0x0,axios_1[a10_0x1c95('0x11')])(_0x120157);}[a10_0x1c95('0x31')](_0x366488){return __awaiter(this,void 0x0,void 0x0,function*(){var _0x19a8a0;const _0xa24ed0=(0x0,metric_logger_1['createMetricRecorder'])(a10_0x1c95('0x7'));let _0xa34308;if(environment_1[a10_0x1c95('0x16')]){output[a10_0x1c95('0x2f')]({'title':a10_0x1c95('0x0'),'bodyLines':[JSON[a10_0x1c95('0x3')](_0x366488,null,0x2)]});}try{_0xa34308=yield(0x0,axios_1[a10_0x1c95('0x23')])(()=>this[a10_0x1c95('0x28')][a10_0x1c95('0x26')]('/nx-cloud/executions/start',_0x366488));_0xa24ed0[a10_0x1c95('0x1f')]((0x0,metric_logger_1[a10_0x1c95('0x25')])(_0xa34308));}catch(_0x132f29){_0xa24ed0['recordMetric'](((_0x19a8a0=_0x132f29===null||_0x132f29===void 0x0?void 0x0:_0x132f29['axiosException'])===null||_0x19a8a0===void 0x0?void 0x0:_0x19a8a0['response'])?(0x0,metric_logger_1['mapRespToPerfEntry'])(_0x132f29[a10_0x1c95('0x1b')][a10_0x1c95('0x2a')]):metric_logger_1[a10_0x1c95('0x22')]);throw _0x132f29;}if(!_0xa34308[a10_0x1c95('0x1e')][a10_0x1c95('0xa')]){throw new Error(a10_0x1c95('0x1'));}if(_0xa34308[a10_0x1c95('0x1e')][a10_0x1c95('0x20')]){throw new Error(_0xa34308['data'][a10_0x1c95('0x20')]);}return _0xa34308[a10_0x1c95('0x1e')]['id'];});}[a10_0x1c95('0x5')](_0x169525){return __awaiter(this,void 0x0,void 0x0,function*(){var _0x2ff59e;const _0x1f8701=(0x0,metric_logger_1[a10_0x1c95('0xe')])(a10_0x1c95('0x18'));try{const _0x4b1edb=yield(0x0,axios_1[a10_0x1c95('0x23')])(()=>this['apiAxiosInstance'][a10_0x1c95('0x26')]('/nx-cloud/executions/status',{'id':_0x169525}));_0x1f8701[a10_0x1c95('0x1f')]((0x0,metric_logger_1['mapRespToPerfEntry'])(_0x4b1edb));return _0x4b1edb[a10_0x1c95('0x1e')];}catch(_0x3a799c){_0x1f8701[a10_0x1c95('0x1f')](((_0x2ff59e=_0x3a799c===null||_0x3a799c===void 0x0?void 0x0:_0x3a799c['axiosException'])===null||_0x2ff59e===void 0x0?void 0x0:_0x2ff59e[a10_0x1c95('0x2a')])?(0x0,metric_logger_1[a10_0x1c95('0x25')])(_0x3a799c[a10_0x1c95('0x1b')][a10_0x1c95('0x2a')]):metric_logger_1['RUNNER_FAILURE_PERF_ENTRY']);output[a10_0x1c95('0x20')]({'title':_0x3a799c[a10_0x1c95('0xc')]});process['exit'](0x1);}});}[a10_0x1c95('0x1c')](_0x37a29c,_0x7acfc2,_0x4b3b90,_0xb15adc,_0x31d688){return __awaiter(this,void 0x0,void 0x0,function*(){var _0x5c13fe;const _0x5897d4=(0x0,metric_logger_1['createMetricRecorder'])(a10_0x1c95('0x14'));if(environment_1[a10_0x1c95('0x16')]){output['note']({'title':a10_0x1c95('0x32'),'bodyLines':['ciExecutionId:\x20'+_0x4b3b90,a10_0x1c95('0x27')+_0xb15adc,a10_0x1c95('0x4')+_0x7acfc2,a10_0x1c95('0x21')+_0x31d688]});}try{const _0x1ff7d3=yield(0x0,axios_1[a10_0x1c95('0x23')])(()=>this[a10_0x1c95('0x28')][a10_0x1c95('0x26')](a10_0x1c95('0x1a'),{'branch':_0x37a29c,'runGroup':_0x7acfc2,'ciExecutionId':_0x4b3b90,'ciExecutionEnv':_0xb15adc,'criticalErrorMessage':_0x31d688}),0x3);_0x5897d4[a10_0x1c95('0x1f')]((0x0,metric_logger_1[a10_0x1c95('0x25')])(_0x1ff7d3));}catch(_0x35cc3f){_0x5897d4[a10_0x1c95('0x1f')](((_0x5c13fe=_0x35cc3f===null||_0x35cc3f===void 0x0?void 0x0:_0x35cc3f[a10_0x1c95('0x1b')])===null||_0x5c13fe===void 0x0?void 0x0:_0x5c13fe[a10_0x1c95('0x2a')])?(0x0,metric_logger_1['mapRespToPerfEntry'])(_0x35cc3f[a10_0x1c95('0x1b')][a10_0x1c95('0x2a')]):metric_logger_1['RUNNER_FAILURE_PERF_ENTRY']);}});}}exports[a10_0x1c95('0x13')]=DistributedExecutionApi;function createStartRequest(_0x123164,_0x58b3ac,_0x19cf94,_0x30bc13,_0x403bec,_0x2cccb9,_0xcb9694){const _0x2757d7=_0x403bec[a10_0x1c95('0x17')](_0x5788be=>{return _0x5788be['map'](_0x5ef9df=>{return{'taskId':_0x5ef9df['id'],'hash':_0x5ef9df[a10_0x1c95('0x9')],'projectName':_0x5ef9df['target']['project'],'target':_0x5ef9df[a10_0x1c95('0xf')][a10_0x1c95('0xf')],'configuration':_0x5ef9df[a10_0x1c95('0xf')][a10_0x1c95('0x2d')]||null,'params':(0x0,serializer_overrides_1['serializeOverrides'])(_0x5ef9df),'projectRoot':_0x5ef9df[a10_0x1c95('0x33')]};});});const _0x150981={'command':(0x0,environment_1[a10_0x1c95('0x8')])(),'branch':_0x123164,'runGroup':_0x58b3ac,'ciExecutionId':_0x19cf94,'ciExecutionEnv':_0x30bc13,'tasks':_0x2757d7,'maxParallel':calculateMaxParallel(_0x2cccb9),'commitSha':_0xcb9694};if(environment_1[a10_0x1c95('0x30')]){_0x150981['agentCount']=environment_1[a10_0x1c95('0x30')];}if(!environment_1['NX_CLOUD_DISTRIBUTED_EXECUTION_STOP_AGENTS_ON_FAILURE']){_0x150981[a10_0x1c95('0x2b')]=![];}return _0x150981;}exports[a10_0x1c95('0x1d')]=createStartRequest;function calculateMaxParallel(_0x504b64){if(_0x504b64['parallel']===a10_0x1c95('0x19')||_0x504b64[a10_0x1c95('0x15')]===![]){return 0x1;}else if(_0x504b64[a10_0x1c95('0x15')]===a10_0x1c95('0x2')||_0x504b64[a10_0x1c95('0x15')]===!![]){return Number(_0x504b64[a10_0x1c95('0x2e')]||0x3);}else if(_0x504b64[a10_0x1c95('0x15')]===undefined){return _0x504b64[a10_0x1c95('0x2e')]?Number(_0x504b64['maxParallel']):0x3;}else{return Number(_0x504b64[a10_0x1c95('0x15')])||0x3;}}